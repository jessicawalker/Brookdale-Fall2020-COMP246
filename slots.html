<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Jackpot! | Jessica Walker</title>
        <meta charset="utf-8">

        <style>

            @keyframes reelSpin {
                from {margin-top: -100px;}
                to {margin-top: -1900px;}
              }

            body {
                overflow: hidden;
            }

            #machine {
                background-color: darksalmon;
                border: 5px solid black;
                height: 500px;
                margin: 100px auto;
                padding: 20px 0 50px;
                text-align: center;
                width: 725px;
            }
            #displayFruitReel1, #displayFruitReel2, #displayFruitReel3 {
                /*animation-name: reelSpin;
                animation-duration: 3s;
                animation-delay: 1s;
                animation-iteration-count: 10;
                transform: translate(50px, 100px);*/

                font-size: 150px;
                height: 260px;
                margin-bottom: 100px;
                margin-top: -100px;
                text-align: center;
                width: 200px;
            }

            .reel {
                background-color: white;
                float: left;
                margin: 0 20px;
                height: 400px;
                overflow: hidden;
                width: 200px;
            }

            #playBtn {
                background-color: yellow;
                clear: both;
                font-size: 20px;
                font-weight: bold;
                padding: 10px 30px;
            }

            #playBtn:hover {
                box-shadow: 0 0 10px 10px yellow;
                cursor: pointer;
            }

            #playBtn:active {
                background-color: rgb(221, 204, 50);
                box-shadow: 0 0 10px 10px yellow;
                cursor: pointer;
                padding: 12px 30px 8px;
                /*margin-top: 2px;
                padding: 6px 26px;*/
            }

            #winner {
                clear: both;
                padding: 30px;
                visibility: hidden;
            }
              
              .animate {
                 animation-name: reelSpin;
                 /*animation-duration: 1250ms;*/
                 animation-iteration-count: 3;
                 animation-timing-function: linear;
              }

              .endspin {
                transform: translate(0,-1000px);
                -webkit-transform: translate(0,-1000px);
                -o-transform: translate(0,-1000px); 
                -moz-transform: translate(0,-1000px);
/*
                transition: all 2s ease-in-out;
                -webkit-transition: all 2s ease-in-out;
                -moz-transition: all 2s ease-in-out;
                -o-transition: all 2s ease-in-out;*/


                transition: all 300ms linear;
                -webkit-transition: all 300ms linear;
                -moz-transition: all 300ms linear;
                -o-transition: all 300ms linear;
            }
        </style>
    </head>
    <body>
    <!--
    When the user clicks the button, pick a random fruit for each reel and display the three fruits in a row as emojis
    
    It all three fruits match, output "Winner, winner, chicken dinner!" to a <div> element below the fruits
    -->

    <div id="machine" style="overflow: hidden;">
        
        <div id="reel1" class="reel"><div id="displayFruitReel1">X</div></div>
        <div id="reel2" class="reel"><div id="displayFruitReel2">X</div></div>
        <div id="reel3" class="reel"><div id="displayFruitReel3">X</div></div>
        <div id="winner">Winner, winner, chicken dinner!</div>
        <button id="playBtn" type="button" onclick="playGame()">Spin!</button>
    </div>




    <script>
        var fruitArray = ["üçá", "üçâ", "üçä", "üçë", "üçã", "üçé", "üçí", "üçì", "üçê"];
        //var fruitDisplay = fruitArray.toString().replace(/,/g, "\n") + "\n";
        //var REPEAT_FRUIT = 2;
        var displayFruitReel1 = document.getElementById("displayFruitReel1");
        var displayFruitReel2 = document.getElementById("displayFruitReel2");
        var displayFruitReel3 = document.getElementById("displayFruitReel3");
        var winner = document.getElementById("winner");

        var REELS = 3;
        var SPIN_DURATION = 1250;
        var ITERATIONS = 3;

        // populate reels with fruit emoji symbols
        displayFruit();

        function displayFruit() {

            // start with "for display only" fruit
            displayFruitReel1.innerText = "üçê";
            displayFruitReel2.innerText = "üçê";
            displayFruitReel3.innerText = "üçê";
            
            // populate with actual fruit array
            for (var i = 0; i < fruitArray.length; i++) {
                displayFruitReel1.innerText += fruitArray[i];
                displayFruitReel2.innerText += fruitArray[i];
                displayFruitReel3.innerText += fruitArray[i];
            }

            // end with "for display only" fruit
            displayFruitReel1.innerText += "üçá";
            displayFruitReel2.innerText += "üçá";
            displayFruitReel3.innerText += "üçá";

        }

        function playGame() {
            winner.style.visibility = "hidden";

            displayFruitReel1.className = "";
            displayFruitReel2.className = "";
            displayFruitReel3.className = "";

            displayFruitReel1.style.transform = "";
            displayFruitReel1.style.transition = "";

            displayFruitReel2.style.transform = "";
            displayFruitReel2.style.transition = "";

            displayFruitReel3.style.transform =  "";
            displayFruitReel3.style.transition = "";
            setTimeout(spinReel, 300);
        }

        function spinReel() {

            displayFruitReel1.className = "animate";
            displayFruitReel1.style.animationDelay = "100ms";
            displayFruitReel1.style.animationDuration = SPIN_DURATION + "ms";
            displayFruitReel2.className = "animate";
            displayFruitReel2.style.animationDelay = "300ms";
            displayFruitReel2.style.animationDuration = SPIN_DURATION + "ms";
            displayFruitReel3.className = "animate";
            displayFruitReel3.style.animationDelay = "500ms";
            displayFruitReel3.style.animationDuration = SPIN_DURATION + "ms";

            setTimeout(stopSpin, SPIN_DURATION * ITERATIONS);
            
            // animation of icons moving upward, then stops
            // must work with three separate slots side-by-side
            //      can it do the slow down and bounce back up thing like real life?
            //      can it have a delay between slots, like real life?
        }

        var fruitArray = ["üçá", "üçâ", "üçä", "üçë", "üçã", "üçé", "üçí", "üçì", "üçê"];
        // DURATION ISN'T THE ANSWER, IT'S THE MARGIN TOP NEGATIVE THAT DETERMINES THE ANSWER!
        // stop each reel
        function pickStop() {

            // 0 - grape = 0
            // 1 - watermelon = -200px
            // 2 - orange = -400px
            // 3 - peach = -600px
            // 4 - lemon = -800px
            // 5 - apple = -1000px
            // 6 - cherry = -1200px
            // 7 - strawberry = -1400px
            // 8 - pear = -1600px

            // choose a random fruit
            var stoppedFruit = Math.floor(Math.random() * fruitArray.length);
            var stopPoint = -(stoppedFruit * 200);
            return stopPoint;






/*
            // how long is each fruit on the screen
            var msPerFruit = Math.round(SPIN_DURATION / fruitArray.length);

            // choose a random fruit
            var stoppedFruit = Math.floor(Math.random() * fruitArray.length);

            // how many ms to get to that fruit from the beginning
            var stopAtMS = msPerFruit * stoppedFruit;

            return stopAtMS;*/

        }

        // kicks in after timeout completes in spinReel
        function stopSpin() {

            var endreel1 = pickStop();
            var endreel2 = pickStop();
            var endreel3 = pickStop();

            displayFruitReel1.className = "";
            displayFruitReel2.className = "";
            displayFruitReel3.className = "";

            //displayFruitReel1.style.transform = "translate(0,-800px)";
            displayFruitReel1.style.transform = "translate(0," + endreel1 + "px)";
            displayFruitReel1.style.transition = "all " + SPIN_DURATION + "ms cubic-bezier(0, 0, 0, 1) 0s";

            //displayFruitReel2.style.transform = "translate(0,-400px)";
            displayFruitReel2.style.transform = "translate(0," + endreel2 + "px)";
            displayFruitReel2.style.transition = "all " + SPIN_DURATION + "ms cubic-bezier(0, 0, 0, 1) 0s";

            //displayFruitReel3.style.transform = "translate(0,-1000px)";
            displayFruitReel3.style.transform = "translate(0," + endreel3 + "px)";
            displayFruitReel3.style.transition = "all " + SPIN_DURATION + "ms cubic-bezier(0, 0, 0, 1) 0s";
            /*var duration1 = pickStop() + "ms";
            var duration2 = pickStop() + "ms";
            var duration3 = pickStop() + "ms";
            displayFruitReel1.style.animationDuration = duration1;
            displayFruitReel2.style.animationDuration = duration2;
            displayFruitReel3.style.animationDuration = duration3;*/
            //pickStop();
            setTimeout(evaluateReels, SPIN_DURATION, endreel1, endreel2, endreel3);
            //evaluateReels(endreel1, endreel2, endreel3);

        }

        function evaluateReels(endreel1, endreel2, endreel3) {
            if (endreel1 == endreel2 && endreel1 == endreel3) {
                winner.style.visibility = "visible";
            }
            // if value of all three reels match, trigger win
            // otherwise, nuttin'!
        }

    </script>
    </body>
    </html>