<!DOCTYPE html>
<html lang="en">
<head>
  <title>Pac-Man</title>
  <style>
  </style>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>  
</head>

<body>
  <h3>Pac-Man</h3>
  <textarea rows="50" cols="100" id="msg" style="font-size:10px;font-family:courier"></textarea>
  
  <script>
    var ROWS = 50;
    var COLS = 100;
    var num_eaten = 0;
    var arr = [];
    var id; //interval ID
    
    //create a 2D array of '.' chars
    for (row=0; row < ROWS; row++) {
      temp = [];
      for (col=0; col < COLS; col++) {
        temp.push('.');
      }
      arr.push(temp);
    }
    
    //put the '@' character in the middle
    r = ROWS/2;
    c = COLS/2;
    arr[r][c] = '@';

    function chomp() {
      //move up, down, left, right
      i = Math.floor(Math.random()*4);
      newr = r;
      newc = c;
      switch(i) {
        case 0:
          //up
          newr = newr - 1;
          break;
        case 1:
          //down
          newr = newr + 1;
          break;
        case 2:
          //left
          newc = newc - 1;
          break;
        case 3:
          //right
          newc = newc + 1;
          break;
        default:
          console.log('should not get here');
      }
      
      if (newr >= 0 && newc >= 0 && newr < ROWS && newc < COLS) {
        //move
        arr[r][c] = ' '; //make my previous location a space
        
        if (arr[newr][newc] == '.')
          num_eaten++;
        
        arr[newr][newc] = '@'; //make new location me (@)
        r = newr;
        c = newc;
        
        //draw
        str = '';
        for (row=0; row < ROWS; row++) {
          for (col=0; col < COLS; col++) {
            str += arr[row][col];
          }
          str += '\n';
        }
        $("#msg").val(str);
      }
      
      //if we've eaten 25% of the dots, then quit
      if (num_eaten >= (ROWS*COLS)/4.0 ) {
        clearInterval(id);
        console.log('25% eaten. done.');
        return;
      }

    }
    
    
    //when document is ready
    $(document).ready(function(){
      
      id = setInterval( function() {chomp(); } , 0);
      
    });


    
  </script>
  
  
</body>


</html>
