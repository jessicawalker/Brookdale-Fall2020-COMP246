<!DOCTYPE html>
<html lang="en">
<head>
  <title>Random Walk</title>
</head>

<body>

  <canvas id="myCanvas" width="800" height="800" style="border:1px solid black;"></canvas>  

  <script>
  var canvas = document.getElementById("myCanvas");
  var ctx = canvas.getContext("2d");
  var iterations = 0;
  var color_iterations = 0;
  var idx = 0;
  var MAX_ITERATIONS = 100000;
  var colors = ['red','orange','yellow','green','blue','indigo','violet'];

  //color canvas white
  ctx.fillStyle = "white";
  ctx.fillRect(0, 0, canvas.width, canvas.height);
  
  //do the random walk
  ctx.fillStyle = "red";
  x = canvas.width / 2; //start in the middle
  y = canvas.height / 2;

  function walk() {
    ctx.beginPath();
    ctx.moveTo(x,y);
    m = Math.floor(Math.random() * 4);
    newx = x;
    newy = y;
    switch(m) {
      case 0:
        //up
        newy = newy - 10;
        break;
      case 1:
        newy = newy + 10;
        //down
        break;
      case 2:
        //left
        newx = newx - 10;
        break;
      case 3:
        //right
        newx = newx + 10;
        break;
      default:
        console.log('should not happen');
    }
    
    //if off the grid, skip this step
    if (!(newx < 0 || newy < 0 || newx > canvas.width || newy > canvas.height)) {
      ctx.lineTo(newx,newy);
      ctx.stroke();
      x = newx;
      y = newy;
      ctx.closePath();
    }
    
    color_iterations++;

    if (color_iterations >= 1000) {
      color_iterations = 0;
      idx++;
      if (idx > 7)
        idx = 0;
    }
    ctx.strokeStyle = colors[idx];
    
    iterations++;
    if (iterations > MAX_ITERATIONS) {
      clearInterval(id);
      console.log('done.');
      return;
    }
    
  }
  
  //NEW 
  //randomly walk 100,000 times
  //if over the edge, skip the drawing for that iteration
  //use rainbow colors, changing the color every 1,000 iterations
  console.log('running...');
  var id = setInterval( function() {walk(); } , 0);
    
    
  </script>
  
</body>

</html>
